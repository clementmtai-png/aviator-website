<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>StakeBets | Premium Crash Platform</title>
    <link rel="stylesheet" href="styles.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&family=JetBrains+Mono:wght@500;700&display=swap"
        rel="stylesheet">
</head>

<body class="dark-theme">
    <div id="app">
        <!-- TOP NAVIGATION -->
        <nav class="navbar redesigned">
            <div class="nav-left">
                <div class="logo-text">STAKE<span>BETS</span></div>
            </div>
            <div class="nav-center">
                <div class="balance-container hidden" id="balance-area">
                    <button class="balance-pill-ref" id="balance-pill" onclick="UI.toggleBalanceMenu()">
                        <span class="bag-icon">ðŸ’°</span>
                        <span class="balance-val" id="user-balance">0.00</span>
                        <span class="curr-label">KES</span>
                    </button>
                    <div class="balance-dropdown" id="balance-dropdown">
                        <button
                            onclick="UI.showModal('wallet-modal'); Wallet.showDepositTab(); UI.toggleBalanceMenu();">Deposit</button>
                        <button
                            onclick="UI.showModal('wallet-modal'); Wallet.showWithdrawTab(); UI.toggleBalanceMenu();">Withdraw</button>
                    </div>
                </div>
            </div>
            <div class="nav-right">
                <button class="login-btn-nav" id="login-btn-nav" onclick="UI.showModal('login-modal')">Login</button>
                <button class="register-btn-nav" id="register-btn-nav"
                    onclick="UI.showModal('register-modal')">Register</button>
                <button class="logout-icon-btn" id="logout-btn-nav">
                    <span class="logout-icon">ðŸšª</span>
                    <span class="logout-text-label">Log out</span>
                </button>
            </div>
        </nav>

        <main class="main-content">
            <div id="views-container">
                <!-- VIEW 1: GAME -->
                <section class="view-panel active" id="game-view">
                    <section class="game-container">
                        <div class="history-bar-top" id="history-pills">
                            <!-- Color-coded history pills -->
                        </div>

                        <div class="game-stage">
                            <div class="canvas-wrapper">
                                <canvas id="game-canvas"></canvas>
                                <div class="multiplier-overlay">
                                    <div id="multiplier-value">1.00x</div>
                                </div>
                                <div id="crash-msg" class="crash-overlay hidden">
                                    <span class="flew-away">FLEW AWAY!</span>
                                    <span id="final-multiplier">2.50x</span>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- DUAL BETTING MODULES -->
                    <div class="controls-grid">
                        <!-- Bet Module 1 -->
                        <div class="bet-module">
                            <div class="control-tabs">
                                <button class="c-tab active">Bet</button>
                            </div>
                            <div class="bet-module-content">
                                <div class="amount-input-row">
                                    <div class="input-wrapper">
                                        <input type="number" value="100.00" step="1" class="bet-primary-input"
                                            id="bet-amount">
                                    </div>
                                    <div class="qty-controls">
                                        <button class="qty-p" onclick="UI.adjustBet(2.0)">+</button>
                                        <button class="qty-m" onclick="UI.adjustBet(0.5)">-</button>
                                    </div>
                                </div>
                                <div class="quick-presets-grid">
                                    <button onclick="UI.setBet(50)">50</button>
                                    <button class="active" onclick="UI.setBet(100)">100</button>
                                    <button onclick="UI.setBet(250)">250</button>
                                    <button onclick="UI.setBet(500)">500</button>
                                </div>
                                <button class="bet-btn-main action-bet" id="action-btn">
                                    <span class="btn-icon">ðŸŽ°</span>
                                    <span class="btn-text">BET</span>
                                    <span class="btn-subtext">100.00 KES</span>
                                </button>
                            </div>
                        </div>

                        <!-- Bet Module 2 (Mirror for UI match) -->
                        <div class="bet-module m-hide-mobile">
                            <div class="control-tabs">
                                <button class="c-tab active">Bet</button>
                                <button class="c-tab active">Bet</button>
                            </div>
                            <div class="bet-module-content">
                                <div class="amount-input-row">
                                    <div class="input-wrapper">
                                        <input type="number" value="100.00" step="1" class="bet-primary-input">
                                    </div>
                                    <div class="qty-controls">
                                        <button class="qty-p">+</button>
                                        <button class="qty-m">-</button>
                                    </div>
                                </div>
                                <div class="quick-presets-grid">
                                    <button>50</button>
                                    <button class="active">100</button>
                                    <button>250</button>
                                    <button>500</button>
                                </div>
                                <button class="bet-btn-main action-bet-next">
                                    <span class="btn-icon">ðŸš€</span>
                                    <span class="btn-text">BET NEXT</span>
                                    <span class="btn-subtext">100.00 KES</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- REINTEGRATED STATS (Scrollable) -->
                    <section class="stats-container game-view-stats">
                        <div class="stats-tabs">
                            <button class="s-tab active" data-tab="all">ALL BETS</button>
                            <button class="s-tab" data-tab="my">MY BETS</button>
                            <button class="s-tab" data-tab="top">TOP</button>
                        </div>
                        <div class="stats-content">
                            <div class="stats-header">
                                <span>PLAYER</span>
                                <span>BET KES</span>
                                <span>X</span>
                                <span>WIN KES</span>
                            </div>
                            <div class="stats-list stats-list-area">
                                <!-- Injected by bets.js -->
                            </div>
                        </div>
                    </section>
                </section>

                <!-- VIEW 2: BETS (Full Screen) -->
                <section class="view-panel" id="sidebar-bets">
                    <section class="stats-container full-stats">
                        <div class="stats-tabs">
                            <button class="s-tab active" data-tab="all">ALL BETS</button>
                            <button class="s-tab" data-tab="my">MY BETS</button>
                            <button class="s-tab" data-tab="top">TOP</button>
                        </div>
                        <div class="stats-content">
                            <div class="stats-header">
                                <span>PLAYER</span>
                                <span>BET KES</span>
                                <span>X</span>
                                <span>WIN KES</span>
                            </div>
                            <div class="stats-list stats-list-area">
                                <!-- Injected by bets.js -->
                            </div>
                        </div>
                    </section>
                </section>

                <!-- VIEW 3: CHAT -->
                <section class="view-panel" id="sidebar-chat">
                    <div class="chat-container-compact">
                        <div class="chat-messages" id="chat-area">
                            <!-- Messages -->
                        </div>
                        <div class="chat-input-row">
                            <input type="text" id="chat-input" placeholder="Type a message...">
                            <button id="send-chat">Send</button>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- BOTTOM TAB NAVIGATION -->
        <div id="mobile-tabs" class="mobile-tabs">
            <button class="m-tab active" id="tab-game" onclick="UI.switchMobileTab('game-view', this)">
                <span class="m-icon">ðŸŽ®</span>
                <span>Game</span>
            </button>
            <button class="m-tab" id="tab-bets" onclick="UI.switchMobileTab('sidebar-bets', this)">
                <span class="m-icon">ðŸ“Š</span>
                <span>Bets</span>
            </button>
            <button class="m-tab" id="tab-chat" onclick="UI.switchMobileTab('sidebar-chat', this)">
                <span class="m-icon">ðŸ’¬</span>
                <span>Chat</span>
            </button>
        </div>

        <!-- FLOATING CUSTOMER CARE -->
        <button class="fab-care-circle" id="care-btn">
            <span class="chat-icon-fab">ðŸ’¬</span>
            <span class="notification-badge">1</span>
        </button>

        <!-- MODALS -->
        <div id="modals">
            <!-- Login Modal -->
            <div class="modal hidden" id="login-modal">
                <div class="modal-content glass">
                    <button class="close-modal" onclick="UI.hideModal('login-modal')">&times;</button>
                    <h2>Welcome Back</h2>
                    <form id="login-form">
                        <input type="text" placeholder="Username or Phone" required>
                        <input type="password" placeholder="Password" required>
                        <button type="submit" class="submit-btn">Login</button>
                    </form>
                </div>
            </div>

            <!-- Register Modal -->
            <div class="modal hidden" id="register-modal">
                <div class="modal-content glass">
                    <button class="close-modal" onclick="UI.hideModal('register-modal')">&times;</button>
                    <h2>Create Account</h2>
                    <form id="register-form">
                        <input type="text" id="reg-user" placeholder="Desired Username" required>
                        <input type="tel" id="reg-phone" placeholder="Phone Number" required>
                        <input type="password" placeholder="Password" required>
                        <button type="submit" class="submit-btn primary">Join Now</button>
                    </form>
                </div>
            </div>

            <!-- Wallet Modal -->
            <div class="modal hidden" id="wallet-modal">
                <div class="modal-content glass wide">
                    <button class="close-modal" onclick="UI.hideModal('wallet-modal')">&times;</button>
                    <div class="wallet-tabs">
                        <button class="w-tab active" data-wallet-tab="deposit">Deposit</button>
                        <button class="w-tab" data-wallet-tab="withdraw">Withdraw</button>
                    </div>
                    <!-- Deposit panel -->
                    <div class="wallet-body" id="wallet-deposit-panel">
                        <h3>Pay via Pesapal</h3>

                        <div class="input-group-wallet">
                            <label for="dep-amount">Amount (KES)</label>
                            <input type="number" placeholder="Min 500" id="dep-amount" class="wallet-input" min="500">
                        </div>

                        <button class="submit-btn primary" onclick="Wallet.deposit()">Confirm Deposit</button>
                        <p class="deposit-hint">Secure payment via Pesapal (supports M-PESA and Cards).</p>
                    </div>
                    <!-- Withdraw panel -->
                    <div class="wallet-body hidden" id="wallet-withdraw-panel">
                        <h3>Withdraw Funds</h3>

                        <div class="input-group-wallet">
                            <label for="withdraw-amount">Amount (KES)</label>
                            <input type="number" placeholder="Min 1500" id="withdraw-amount" class="wallet-input"
                                min="1500">
                        </div>

                        <div class="input-group-wallet">
                            <label for="withdraw-phone">Phone Number (M-PESA)</label>
                            <input type="text" placeholder="2547XXXXXXXX" id="withdraw-phone" class="wallet-input">
                        </div>

                        <button class="submit-btn primary withdraw-submit" onclick="Wallet.requestWithdraw()">Confirm
                            Withdrawal</button>
                    </div>
                </div>
            </div>

            <!-- Admin Modal (Hidden) -->
            <div class="modal hidden" id="admin-modal">
                <div class="modal-content glass extra-wide">
                    <button class="close-modal" onclick="UI.hideModal('admin-modal')">&times;</button>
                    <h2 class="admin-title">SYSTEM CONTROL PANEL</h2>
                    <div class="admin-grid">
                        <div class="admin-card">
                            <h3>Next Crash Point</h3>
                            <div class="flex-row">
                                <input type="number" id="next-crash-input" step="0.01" placeholder="Auto">
                                <button onclick="Admin.setNextCrash()">FORCE</button>
                            </div>
                            <button class="submit-btn" style="margin-top: 10px; padding: 10px;"
                                onclick="Admin.showForcePopup()">FORCE RUN POPUP</button>
                            <p class="hint">Leave empty for organic random</p>
                        </div>
                        <div class="admin-card">
                            <h3>User Monitoring</h3>
                            <div id="admin-user-list" class="mini-list">
                                <!-- User balances here -->
                            </div>
                        </div>
                        <div class="admin-card">
                            <h3>Active Round</h3>
                            <div id="admin-live-stats">
                                <!-- Live bets info -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/logic.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/wallet.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/engine.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/bets.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>

</html>